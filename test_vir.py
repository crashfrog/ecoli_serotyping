
import src.serotypePrediction
from argparse import Namespace


CONST_CSV = False
CONST_INPUT = 'filename'
CONST_MINGENOMES = 1
CONST_PERIDENT = 90
CONST_PERLEN = 90
CONST_SER = True
CONST_VIR = True





def test_sero_pred() :


    testing_data = [{'H': 'H7', 'name': 'AE005174.2', 'file': 'GCA_000006665.1_ASM666v1_genomic.fna', 'O': 'O157', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AE005174.2', 'send': '2842523', 'qseqid': 'gnd|1_O26', 'pident': '93.45', 'sstart': '2843163', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'wzy': {'antigen': 'O157', 'blast_record': {'sseqid': 'AE005174.2', 'send': '2855767', 'qseqid': 'wzy_199_AKLQ01000042_O157', 'pident': '99.87', 'sstart': '2856508', 'sframe': '1', 'length': '742', 'qlen': '741'}}, 'fliC': {'antigen': 'H7', 'blast_record': {'sseqid': 'AE005174.2', 'send': '2699592', 'qseqid': '1__fliC__fliC-H7__70', 'pident': '99.94', 'sstart': '2701348', 'sframe': '1', 'length': '1757', 'qlen': '1758'}}, 'wzx': {'antigen': 'O157', 'blast_record': {'sseqid': 'AE005174.2', 'send': '2853432', 'qseqid': 'wzx_200_AKLI01000048_O157', 'pident': '99.93', 'sstart': '2854788', 'sframe': '1', 'length': '1357', 'qlen': '1356'}}}, 'otype': {'strength': '99.93', 'ant_number': 'O157'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H2', 'name': 'AP010958.1', 'file': 'GCA_000010745.1_ASM1074v1_genomic.fna', 'O': 'O103', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AP010958.1', 'send': '2510848', 'qseqid': 'gnd|1_O26', 'pident': '96.26', 'sstart': '2511488', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'fliC': {'antigen': 'H2', 'blast_record': {'sseqid': 'AP010958.1', 'send': '2243220', 'qseqid': '1__fliC__fliC-H2__20', 'pident': '99.60', 'sstart': '2244708', 'sframe': '1', 'length': '1489', 'qlen': '1497'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H28', 'name': 'CP000800.1', 'file': 'GCA_000017745.1_ASM1774v1_genomic.fna', 'O': 'O139', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'CP000800.1', 'send': '2282905', 'qseqid': 'gnd|1_O26', 'pident': '95.17', 'sstart': '2283546', 'sframe': '1', 'length': '642', 'qlen': '643'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H7', 'name': 'CP001846.1', 'file': 'GCA_000025165.1_ASM2516v1_genomic.fna', 'O': 'O55', 'output': {'serotype': {'fliC': {'antigen': 'H7', 'blast_record': {'sseqid': 'CP001846.1', 'send': '2394221', 'qseqid': '1__fliC__fliC-H7__70', 'pident': '100.00', 'sstart': '2395977', 'sframe': '1', 'length': '1757', 'qlen': '1758'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H11', 'name': 'AP010953.1', 'file': 'GCA_000091005.1_ASM9100v1_genomic.fna', 'O': 'O26', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AP010953.1', 'send': '2854070', 'qseqid': 'gnd|3_O26', 'pident': '95.48', 'sstart': '2854710', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'fliC': {'antigen': 'H11', 'blast_record': {'sseqid': 'AP010953.1', 'send': '2715723', 'qseqid': '1__fliC__fliC-H11__5', 'pident': '99.93', 'sstart': '2717181', 'sframe': '1', 'length': '1459', 'qlen': '1467'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H4', 'name': 'AFOB02', 'file': 'GCA_000215685.3_Ecoli.O104_H4.LB226692_2.0_genomic.fna', 'O': 'O104', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AFOB02000091.1', 'send': '153567', 'qseqid': 'gnd|1_O26', 'pident': '93.92', 'sstart': '154207', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'fliC': {'antigen': 'H4', 'blast_record': {'sseqid': 'AFOB02000091.1', 'send': '10204', 'qseqid': '1__fliC__fliC-H4__42', 'pident': '99.23', 'sstart': '11241', 'sframe': '1', 'length': '1038', 'qlen': '1050'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H21', 'name': 'AGTH01', 'file': 'GCA_000234235.2_ASM23423v2_genomic.fna', 'O': 'O113', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AGTH01000188.1', 'send': '64859', 'qseqid': 'gnd|1_O26', 'pident': '94.23', 'sstart': '64219', 'sframe': '1', 'length': '641', 'qlen': '643'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H21', 'name': 'AGTI01', 'file': 'GCA_000234255.3_ASM23425v3_genomic.fna', 'O': 'O91', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AGTI01000214.1', 'send': '19836', 'qseqid': 'gnd|1_O26', 'pident': '95.48', 'sstart': '20477', 'sframe': '1', 'length': '642', 'qlen': '643'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H19', 'name': 'AGTJ01', 'file': 'GCA_000234275.3_ASM23427v3_genomic.fna', 'O': 'O121', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AGTJ01000128.1', 'send': '61427', 'qseqid': 'gnd|1_O26', 'pident': '93.93', 'sstart': '62068', 'sframe': '1', 'length': '642', 'qlen': '643'}}, 'fliC': {'antigen': 'H19', 'blast_record': {'sseqid': 'AGTJ01000023.1', 'send': '74760', 'qseqid': '1__fliC__fliC-H19__18', 'pident': '98.36', 'sstart': '76591', 'sframe': '1', 'length': '1832', 'qlen': '1833'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H2', 'name': 'AGTK01', 'file': 'GCA_000234295.2_ASM23429v2_genomic.fna', 'O': 'O45', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AGTK01000379.1', 'send': '55280', 'qseqid': 'gnd|1_O26', 'pident': '94.70', 'sstart': '54639', 'sframe': '1', 'length': '642', 'qlen': '643'}}, 'wzy': {'antigen': 'O45', 'blast_record': {'sseqid': 'AGTK01000379.1', 'send': '50328', 'qseqid': 'wzy_152_AIGX01000028_O45', 'pident': '99.85', 'sstart': '49641', 'sframe': '1', 'length': '688', 'qlen': '687'}}, 'fliC': {'antigen': 'H2', 'blast_record': {'sseqid': 'AGTK01000036.1', 'send': '86453', 'qseqid': '1__fliC__fliC-H2__20', 'pident': '99.60', 'sstart': '87941', 'sframe': '1', 'length': '1489', 'qlen': '1497'}}}, 'otype': {'strength': '99.85', 'ant_number': 'O45'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H28', 'name': 'AGTL01', 'file': 'GCA_000234315.2_ASM23431v2_genomic.fna', 'O': 'O145', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AGTL01000031.1', 'send': '21956', 'qseqid': 'gnd|1_O26', 'pident': '95.32', 'sstart': '22596', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'fliC': {'antigen': 'H28', 'blast_record': {'sseqid': 'AGTL01000001.1', 'send': '42390', 'qseqid': '1__fliC__fliC-H28__29', 'pident': '92.29', 'sstart': '40648', 'sframe': '1', 'length': '1752', 'qlen': '1740'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H25', 'name': 'AGSG01', 'file': 'GCA_000234605.2_ASM23460v2_genomic.fna', 'O': 'O103', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AGSG01000154.1', 'send': '34526', 'qseqid': 'gnd|1_O26', 'pident': '96.26', 'sstart': '35166', 'sframe': '1', 'length': '641', 'qlen': '643'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H43', 'name': 'AHZD02', 'file': 'GCA_000247665.4_EcoliT22_2.0_genomic.fna', 'O': 'O157', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AHZD02000001.1', 'send': '608771', 'qseqid': 'gnd|1_O26', 'pident': '95.48', 'sstart': '608131', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'wzy': {'antigen': 'O157', 'blast_record': {'sseqid': 'AHZD02000001.1', 'send': '595529', 'qseqid': 'wzy_199_AKLQ01000042_O157', 'pident': '99.60', 'sstart': '594788', 'sframe': '1', 'length': '742', 'qlen': '741'}}, 'wzx': {'antigen': 'O157', 'blast_record': {'sseqid': 'AHZD02000001.1', 'send': '597864', 'qseqid': 'wzx_200_AKLI01000048_O157', 'pident': '99.71', 'sstart': '596508', 'sframe': '1', 'length': '1357', 'qlen': '1356'}}}, 'otype': {'strength': '99.71', 'ant_number': 'O157'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H37', 'name': 'AJQW01', 'file': 'GCA_000259425.1_ASM25942v1_genomic.fna', 'O': 'O32', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AJQW01000001.1', 'send': '259080', 'qseqid': 'gnd|1_O26', 'pident': '93.60', 'sstart': '259720', 'sframe': '1', 'length': '641', 'qlen': '643'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H11', 'name': 'AJVS01', 'file': 'GCA_000263935.1_ASM26393v1_genomic.fna', 'O': 'O111', 'output': {'serotype': {'gnd': {'antigen': 'O111', 'blast_record': {'sseqid': 'AJVS01000357.1', 'send': '24352', 'qseqid': 'gnd|62_O111', 'pident': '100.00', 'sstart': '24993', 'sframe': '1', 'length': '642', 'qlen': '643'}}, 'wzy': {'antigen': 'O111', 'blast_record': {'sseqid': 'AJVS01000357.1', 'send': '27545', 'qseqid': '9__wzy__wzy-O111__331', 'pident': '99.81', 'sstart': '28598', 'sframe': '1', 'length': '1054', 'qlen': '1053'}}, 'fliC': {'antigen': 'H11', 'blast_record': {'sseqid': 'AJVS01000516.1', 'send': '100018', 'qseqid': '1__fliC__fliC-H11__5', 'pident': '99.93', 'sstart': '101476', 'sframe': '1', 'length': '1459', 'qlen': '1467'}}}, 'otype': {'strength': '99.81', 'ant_number': 'O111'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H21', 'name': 'AUQB01', 'file': 'GCA_000464915.1_CFSAN002237_01.0_genomic.fna', 'O': 'O104', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AUQB01000007.1', 'send': '140285', 'qseqid': 'gnd|1_O26', 'pident': '93.76', 'sstart': '140924', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'wzx': {'antigen': 'O104', 'blast_record': {'sseqid': 'AUQB01000007.1', 'send': '142231', 'qseqid': 'wzx_106_AFOB02000091_O104', 'pident': '99.88', 'sstart': '143098', 'sframe': '1', 'length': '868', 'qlen': '867'}}}, 'otype': {'strength': '99.88', 'ant_number': 'O104'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H16', 'name': 'AUZS01', 'file': 'GCA_000517245.1_ETEC_B2C_genomic.fna', 'O': 'O6', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AUZS01000181.1', 'send': '39416', 'qseqid': 'gnd|1_O26', 'pident': '95.16', 'sstart': '40056', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'fliC': {'antigen': 'H16', 'blast_record': {'sseqid': 'AUZS01000098.1', 'send': '66600', 'qseqid': '1__fliC__fliC-H16__13', 'pident': '99.94', 'sstart': '68169', 'sframe': '1', 'length': '1570', 'qlen': '1578'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H34', 'name': 'JHJX01', 'file': 'GCA_000614465.2_Ec99-3124_genomic.fna', 'O': 'O86', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHJX01000037.1', 'send': '9214', 'qseqid': 'gnd|1_O26', 'pident': '95.79', 'sstart': '8574', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'wzy': {'antigen': 'O86', 'blast_record': {'sseqid': 'JHJX01000037.1', 'send': '6396', 'qseqid': '9__wzy__wzy-O86__504', 'pident': '99.33', 'sstart': '5053', 'sframe': '1', 'length': '1344', 'qlen': '1341'}}}, 'otype': {'strength': '99.33', 'ant_number': 'O86'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H2', 'name': 'JHMH01', 'file': 'GCA_000614565.2_Ec2010C-5034_genomic.fna', 'O': 'O153', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHMH01000098.1', 'send': '23365', 'qseqid': 'gnd|1_O26', 'pident': '96.10', 'sstart': '24005', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'fliC': {'antigen': 'H2', 'blast_record': {'sseqid': 'JHMH01000073.1', 'send': '11321', 'qseqid': '1__fliC__fliC-H2__20', 'pident': '99.60', 'sstart': '12809', 'sframe': '1', 'length': '1489', 'qlen': '1497'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H11', 'name': 'JHFY01', 'file': 'GCA_000615055.1_Ec2010C-3214_genomic.fna', 'O': 'O103', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHFY01000107.1', 'send': '24140', 'qseqid': 'gnd|1_O26', 'pident': '96.26', 'sstart': '24780', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'fliC': {'antigen': 'H11', 'blast_record': {'sseqid': 'JHFY01000043.1', 'send': '29069', 'qseqid': '1__fliC__fliC-H11__5', 'pident': '99.93', 'sstart': '27611', 'sframe': '1', 'length': '1459', 'qlen': '1467'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H25', 'name': 'JHLP01', 'file': 'GCA_000616285.1_Ec2011C-3602_genomic.fna', 'O': 'O156', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHLP01000018.1', 'send': '44845', 'qseqid': 'gnd|1_O26', 'pident': '96.10', 'sstart': '44205', 'sframe': '1', 'length': '641', 'qlen': '643'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H11', 'name': 'JHLA01', 'file': 'GCA_000616565.1_Ec07-4281_genomic.fna', 'O': 'O69', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHLA01000102.1', 'send': '21307', 'qseqid': 'gnd|1_O26', 'pident': '94.54', 'sstart': '21947', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'fliC': {'antigen': 'H11', 'blast_record': {'sseqid': 'JHLA01000026.1', 'send': '29170', 'qseqid': '1__fliC__fliC-H11__5', 'pident': '99.93', 'sstart': '27712', 'sframe': '1', 'length': '1459', 'qlen': '1467'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H16', 'name': 'JHKX01', 'file': 'GCA_000616625.1_Ec08-3651_genomic.fna', 'O': 'O118', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHKX01000028.1', 'send': '22791', 'qseqid': 'gnd|1_O26', 'pident': '93.46', 'sstart': '23432', 'sframe': '1', 'length': '642', 'qlen': '643'}}, 'fliC': {'antigen': 'H16', 'blast_record': {'sseqid': 'JHKX01000022.1', 'send': '142546', 'qseqid': '1__fliC__fliC-H16__13', 'pident': '99.94', 'sstart': '144115', 'sframe': '1', 'length': '1570', 'qlen': '1578'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H21', 'name': 'JHNW01', 'file': 'GCA_000617205.1_Ec03-3269_genomic.fna', 'O': 'O174', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHNW01000003.1', 'send': '573492', 'qseqid': 'gnd|1_O26', 'pident': '95.76', 'sstart': '572856', 'sframe': '1', 'length': '637', 'qlen': '643'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H4', 'name': 'JHNV01', 'file': 'GCA_000617225.1_Ec03-3458_genomic.fna', 'O': 'O119', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHNV01000080.1', 'send': '50713', 'qseqid': 'gnd|1_O26', 'pident': '93.30', 'sstart': '50072', 'sframe': '1', 'length': '642', 'qlen': '643'}}, 'fliC': {'antigen': 'H4', 'blast_record': {'sseqid': 'JHNV01000079.1', 'send': '80528', 'qseqid': '1__fliC__fliC-H4__42', 'pident': '99.13', 'sstart': '81565', 'sframe': '1', 'length': '1038', 'qlen': '1050'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H7', 'name': 'JHNM01', 'file': 'GCA_000617365.2_Ec06-3501_genomic.fna', 'O': 'O79', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHNM01000013.1', 'send': '149493', 'qseqid': 'gnd|1_O26', 'pident': '93.76', 'sstart': '150133', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'fliC': {'antigen': 'H7', 'blast_record': {'sseqid': 'JHNM01000013.1', 'send': '64322', 'qseqid': '1__fliC__fliC-H7__70', 'pident': '99.72', 'sstart': '66078', 'sframe': '1', 'length': '1757', 'qlen': '1758'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H14', 'name': 'JHNJ01', 'file': 'GCA_000617425.1_Ec06-3691_genomic.fna', 'O': 'O91', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHNJ01000059.1', 'send': '1699', 'qseqid': 'gnd|1_O26', 'pident': '93.93', 'sstart': '1058', 'sframe': '1', 'length': '642', 'qlen': '643'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H25', 'name': 'JHMM01', 'file': 'GCA_000617585.1_Ec2010C-4874_genomic.fna', 'O': 'O165', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHMM01000025.1', 'send': '9695', 'qseqid': 'gnd|1_O26', 'pident': '94.23', 'sstart': '9055', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'fliC': {'antigen': 'H25', 'blast_record': {'sseqid': 'JHMM01000032.1', 'send': '30790', 'qseqid': 'fliC_311_AGSG01000116_H25', 'pident': '96.89', 'sstart': '29471', 'sframe': '1', 'length': '1320', 'qlen': '1332'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H18', 'name': 'JHJE01', 'file': 'GCA_000617985.2_EcK1516_genomic.fna', 'O': 'O15', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHJE01000023.1', 'send': '23634', 'qseqid': 'gnd|1_O26', 'pident': '95.17', 'sstart': '24275', 'sframe': '1', 'length': '642', 'qlen': '643'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H16', 'name': 'JHJY01', 'file': 'GCA_000618005.2_Ec98-3133_genomic.fna', 'O': 'O157', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHJY01000015.1', 'send': '21997', 'qseqid': 'gnd|1_O26', 'pident': '95.32', 'sstart': '22637', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'wzy': {'antigen': 'O157', 'blast_record': {'sseqid': 'JHJY01000064.1', 'send': '11775', 'qseqid': '9__wzy__wzy-O157__388', 'pident': '99.41', 'sstart': '10590', 'sframe': '1', 'length': '1186', 'qlen': '1185'}}, 'fliC': {'antigen': 'H16', 'blast_record': {'sseqid': 'JHJY01000002.1', 'send': '31633', 'qseqid': '1__fliC__fliC-H16__13', 'pident': '99.81', 'sstart': '30064', 'sframe': '1', 'length': '1570', 'qlen': '1578'}}, 'wzx': {'antigen': 'O157', 'blast_record': {'sseqid': 'JHJY01000064.1', 'send': '13868', 'qseqid': 'wzx_200_AKLI01000048_O157', 'pident': '99.41', 'sstart': '12512', 'sframe': '1', 'length': '1357', 'qlen': '1356'}}}, 'otype': {'strength': '99.41', 'ant_number': 'O157'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H41', 'name': 'JHJJ01', 'file': 'GCA_000618205.2_EcF9792_genomic.fna', 'O': 'O169', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHJJ01000027.1', 'send': '4317', 'qseqid': 'gnd|1_O26', 'pident': '94.24', 'sstart': '3676', 'sframe': '1', 'length': '642', 'qlen': '643'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H7', 'name': 'JHHC01', 'file': 'GCA_000619245.1_Ec2009C-3299_genomic.fna', 'O': 'O121', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHHC01000011.1', 'send': '92154', 'qseqid': 'gnd|1_O26', 'pident': '93.93', 'sstart': '91513', 'sframe': '1', 'length': '642', 'qlen': '643'}}, 'fliC': {'antigen': 'H7', 'blast_record': {'sseqid': 'JHHC01000004.1', 'send': '151501', 'qseqid': '1__fliC__fliC-H7__70', 'pident': '99.72', 'sstart': '153257', 'sframe': '1', 'length': '1757', 'qlen': '1758'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H11', 'name': 'JHHB01', 'file': 'GCA_000619325.2_Ec2009C-3307_genomic.fna', 'O': 'O123', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JHHB01000003.1', 'send': '23142', 'qseqid': 'gnd|1_O26', 'pident': '93.60', 'sstart': '23782', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'wzy': {'antigen': 'O123', 'blast_record': {'sseqid': 'JHHB01000003.1', 'send': '30180', 'qseqid': '9__wzy__wzy-O123-O186-Gp5__349', 'pident': '99.92', 'sstart': '31431', 'sframe': '1', 'length': '1252', 'qlen': '1251'}}, 'fliC': {'antigen': 'H11', 'blast_record': {'sseqid': 'JHHB01000020.1', 'send': '21571', 'qseqid': '1__fliC__fliC-H11__5', 'pident': '99.93', 'sstart': '23029', 'sframe': '1', 'length': '1459', 'qlen': '1467'}}}, 'otype': {'strength': '99.92', 'ant_number': 'O123'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H2', 'name': 'AQGP01', 'file': 'GCA_000647455.1_02-04446_clc_bio_denovo_genomic.fna', 'O': 'O174', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AQGP01000004.1', 'send': '586322', 'qseqid': 'gnd|1_O26', 'pident': '95.76', 'sstart': '585686', 'sframe': '1', 'length': '637', 'qlen': '643'}}, 'fliC': {'antigen': 'H2', 'blast_record': {'sseqid': 'AQGP01000031.1', 'send': '96129', 'qseqid': '1__fliC__fliC-H2__20', 'pident': '99.60', 'sstart': '94641', 'sframe': '1', 'length': '1489', 'qlen': '1497'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H46', 'name': 'AQGO01', 'file': 'GCA_000647475.1_I-151_clc_bio_denovo_genomic.fna', 'O': 'O174', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'AQGO01000048.1', 'send': '4318', 'qseqid': 'gnd|1_O26', 'pident': '95.17', 'sstart': '3677', 'sframe': '1', 'length': '642', 'qlen': '643'}}, 'fliC': {'antigen': 'H46', 'blast_record': {'sseqid': 'AQGO01000013.1', 'send': '42746', 'qseqid': '1__fliC__fliC-H46__52', 'pident': '97.45', 'sstart': '41019', 'sframe': '1', 'length': '1728', 'qlen': '1713'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H12', 'name': 'JFBE01', 'file': 'GCA_000701105.2_ASM70110v2_genomic.fna', 'O': 'O78', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JFBE01000001.1', 'send': '357789', 'qseqid': 'gnd|1_O26', 'pident': '94.39', 'sstart': '357148', 'sframe': '1', 'length': '642', 'qlen': '643'}}, 'fliC': {'antigen': 'H12', 'blast_record': {'sseqid': 'JFBE01000053.1', 'send': '9402', 'qseqid': '1__fliC__fliC-H12__9', 'pident': '99.33', 'sstart': '7616', 'sframe': '1', 'length': '1787', 'qlen': '1788'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H25', 'name': 'JASO01', 'file': 'GCA_000703225.1_Ec07-3858_genomic.fna', 'O': 'O145', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JASO01000012.1', 'send': '423158', 'qseqid': 'gnd|1_O26', 'pident': '95.32', 'sstart': '422518', 'sframe': '1', 'length': '641', 'qlen': '643'}}, 'wzy': {'antigen': 'O145', 'blast_record': {'sseqid': 'JASO01000012.1', 'send': '413346', 'qseqid': '9__wzy__wzy-O145__374', 'pident': '99.75', 'sstart': '412158', 'sframe': '1', 'length': '1189', 'qlen': '1188'}}, 'fliC': {'antigen': 'H25', 'blast_record': {'sseqid': 'JASO01000012.1', 'send': '541217', 'qseqid': 'fliC_311_AGSG01000116_H25', 'pident': '96.97', 'sstart': '539898', 'sframe': '1', 'length': '1320', 'qlen': '1332'}}}, 'otype': {'strength': '99.75', 'ant_number': 'O145'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H21', 'name': 'JASR01', 'file': 'GCA_000703285.1_Ec2010C-3325_genomic.fna', 'O': 'O146', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JASR01000005.1', 'send': '126708', 'qseqid': 'gnd|1_O26', 'pident': '93.46', 'sstart': '127349', 'sframe': '1', 'length': '642', 'qlen': '643'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H2', 'name': 'JASU01', 'file': 'GCA_000703345.1_Ec2011C-3317_genomic.fna', 'O': 'O128', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'JASU01000004.1', 'send': '4950', 'qseqid': 'gnd|3_O26', 'pident': '95.61', 'sstart': '4313', 'sframe': '1', 'length': '638', 'qlen': '643'}}, 'fliC': {'antigen': 'H2', 'blast_record': {'sseqid': 'JASU01000004.1', 'send': '106075', 'qseqid': '1__fliC__fliC-H2__20', 'pident': '99.53', 'sstart': '104587', 'sframe': '1', 'length': '1489', 'qlen': '1497'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}, {'H': 'H6', 'name': 'BBUR01', 'file': 'GCA_001592485.1_ASM159248v1_genomic.fna', 'O': 'O119', 'output': {'serotype': {'gnd': {'antigen': 'O26', 'blast_record': {'sseqid': 'BBUR01000041.1', 'send': '23954', 'qseqid': 'gnd|1_O26', 'pident': '93.30', 'sstart': '23313', 'sframe': '1', 'length': '642', 'qlen': '643'}}}, 'otype': {'strength': 0, 'ant_number': '-'}, 'htype': {'strength': 0, 'ant_number': '-'}}}]









    args = Namespace(csv = CONST_CSV, input = CONST_INPUT, minimumGenomes = CONST_MINGENOMES, percentIdentity =CONST_PERIDENT, percentLength = CONST_PERLEN, serotyper = CONST_SER,  virulenceFactors = CONST_VIR)
    for entry in testing_data:
        output = entry['output']['serotype']
        if entry['output']['otype']['strength'] == 0:
           if 'wzy' in output :
                result = src.serotypePrediction.parse_serotype(output['wzy']['blast_record'], args)['serotype']['wzy']['antigen']
                comparison = entry['O']
                assert(result == comparison)
           elif 'wzx' in output :
             result = src.serotypePrediction.parse_serotype(output['wzx']['blast_record'], args)['serotype']['wzx']['antigen']
             comparison = entry['O']
             assert (result == comparison)
        else :
            result = src.serotypePrediction.predict_serotype({entry['name'] : entry['output']})[entry['name']]['otype']['ant_number']
            comparison = entry['O']
            assert (result == comparison)
        if entry['output']['htype']['strength'] == 0:
            if 'fliC' in output:
                result = src.serotypePrediction.parse_serotype(output['fliC']['blast_record'], args)['serotype']['fliC']['antigen']
                comparison = entry['H']
                assert (result == comparison)
        else :
            result = src.serotypePrediction.predict_serotype({entry['name'] : entry['output']})[entry['name']]['htype']['ant_number']
            comparison = entry['H']
            assert (result == comparison)

test_sero_pred()

